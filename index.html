<!doctype html>
<html lang="fr">
	<head>
		<meta charset="utf-8">
		<title>Activit√©s three.js</title>
		<link rel="stylesheet" href="css/style.css">

		<script src="lib/three.min.js"></script>
		<script src="lib/MTLLoader.js"></script>
		<script src="lib/OBJLoader.js"></script>
		<script src="js/data.js"></script>
		<script src="js/base.js"></script>
		<script src="js/scene.js"></script> 

	</head>

	<body>

	</body>

	<script>

		var width, height ; 
		var renderer, scene, camera ;
		var temps, delta, clock,clock2 ;
		var controls ;  
		var grille ;
		init("scene.config") ;  
		animate() ; 

		function init(grapheScene){
			width  = window.innerWidth ; 
			height = window.innerHeight ; 
			
			renderer = new THREE.WebGLRenderer({antialias:true}) ; 
			renderer.setSize(width, height) ; 
			document.body.appendChild(renderer.domElement) ; 

			camera = new THREE.PerspectiveCamera(30, width/height, 0.1, 1000.0) ;
			camera.position.set(0,1.7,0) ;  
			// camera.lookAt(new THREE.Vector3(0,1.5,0)) ; 

			/*var spotLight = new THREE.SpotLight(0xffffff,3,100,Math.PI/2);

			camera.add( spotLight.target );
			spotLight.target.position.set( 0, 0, -0.1 );
			spotLight.position.copy( camera.position );*/

			controls = new KeyboardControls(camera) ; 

			scene = creerScene() ; 
			//scene.add(spotLight);

			temps = 0  ; 
			clock = new THREE.Clock() ; 
			clock2=0;

			window.addEventListener("resize", function (){
				width  = window.innerWidth ; 
				height = window.innerHeight ; 
				camera.aspect = width / height ; 
				camera.updateProjectionMatrix() ; 
				renderer.setSize(width, height) ; 
			}) ; 

			document.addEventListener("mousedown", mouseDown, false) ; 
			// document.addEventListener("mousemove", mouseMove, false) ; 
			document.addEventListener("keydown",   keyDown, false) ; 
			document.addEventListener("keyup",     keyUp, false) ; 
		}


		function animate(){
			requestAnimationFrame(animate) ; 
			delta = clock.getDelta(); 
			temps += delta ;
			clock2+=delta; 
			controls.update(delta) ; 
			renderer.render(scene,camera) ;
			for (nbVisiteur=0;nbVisiteur<scene.visiteurs.length; nbVisiteur++){
				scene.visiteurs[nbVisiteur].update();
			}

			if (clock2>1.0){
				clock2=0; 
				//console.log("AAAHHHH")
				grille.verifierEtat();
				grille.update()		
			}
		}

	</script>
</html>
